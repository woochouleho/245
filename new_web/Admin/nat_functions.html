
<html>
<head>
	<title>H854AX</title>
	<meta http-equiv='Pragma' content='no-cache'>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<meta name="viewport" content="width=device-width, user-scalable=0, initial-scale=1, minimum-scale=1, maximum-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<meta name="description" content=""/>
	<meta name="keywords" content=""/>
	<link rel="stylesheet" href="css/common.css"/>
	<script type="text/javascript" src="js/jquery-1.11.2.js" charset="utf-8"></script>
	<script type="text/javascript" src="js/modernizr.custom.39786.js" charset="utf-8"></script>
	<script type="text/javascript" src="js/response.js" charset="utf-8"></script>
	<script type="text/javascript" src="js/icheck.js" charset="utf-8"></script>
	<script type="text/javascript" src="js/sb_common.js" charset="utf-8"></script>
	<script language="javascript" src="js/util.js"></script>
	<script language="javascript" src="js/popup.js"></script>

<script language="javascript">

var sessionKey='219820191';

var dmz_mode_msg = { 
                        dmz : { name : 'IP 주소' , example : 'IP 주소 : 예)192.168.0.10' },
                        sdmz : { name : 'MAC 주소' , example : 'MAC 주소 :  예) 00:23:aa:00:00:01' }
}

function checkDmz()
{
	var x = document.getElementById("dmzEnable");
    var i = x.selectedIndex;
	var v = document.forms[0].dmzAddr.value;	
	var result  = false;
	
	switch( String(i) )
	{
		case '1' :
			if(v == '') {
				webAlert("DMZ 주소값이 없습니다.");
				result = false;
			}
			if(isValidIpAddress(v) == false) {
				webAlert("유효하지 않은 IP주소입니다 : " + v);
				result = false;
			}
			break;
			
		case '2' :
			if(v == '') {
				webAlert("DMZ 주소값이 없습니다.");
				result = false;
			}
			if(isValidMacAddress(v) == false) {
				webAlert("유효하지 않은 MAC주소입니다 : " + v);
				result = false;
			}
			break;
		
		case '0' :
		default:
			result = true;
			break;
		
	}

	return result;
}

function removeClick(rm_type, rml) {
	var lst = '';
	var loc = '';
	if (rml.length > 0)
		for (i = 0; i < rml.length; i++) {
			if ( rml[i].checked == true )
				lst += rml[i].value + ',';
		}
	else if ( rml.checked == true )
		lst = rml.value;

	if(rm_type)
		loc  = 'scvrtsrv.cmd?action=remove&rmLst=' + lst;
	else
		loc  = 'portfwsrv.cmd?action=remove&rmLst=' + lst;

	loc += '&sessionKey=' + sessionKey;
	var code = 'location="' + loc + '"';
	eval(code);
}

function checkPF()
{
    var es = parseInt(document.forms[0].pf_ex_port_start.value);
    var ee = parseInt(document.forms[0].pf_ex_port_end.value);

    if (isValidIpAddress(document.forms[0].pf_in_ip_addr.value) == false) {
         webAlert('유효하지 않은 내부 IP주소입니다 : ' +document.forms[0].pf_in_ip_addr.value);
        return false;
    }

    if (isValidPort(document.forms[0].pf_ex_port_start.value) == false) {
         webAlert('유효하지 않은 외부 포트 시작 입니다 : ' +document.forms[0].pf_ex_port_start.value);
        return false;
    }

    if (isValidPort(document.forms[0].pf_ex_port_end.value) == false) {
         webAlert('유효하지 않은 외부 포트 끝 입니다 : ' +document.forms[0].pf_ex_port_end.value);
        return false;
    }

    if (isValidPort(document.forms[0].pf_in_port_start.value) == false) {
         webAlert('유효하지 않은 내부 PORT 입니다 : ' +document.forms[0].pf_in_port_start.value);
        return false;
    }

    if(es > ee){
        webAlert('외부포트시작이 외부포트끝 보다 큽니다');
        return false;
    }

	return true;
}

function checkSM()
{
	var es = parseInt(document.forms[0].sm_ex_port_start.value);
	var ee = parseInt(document.forms[0].sm_ex_port_end.value);

	if (isValidIpAddress(document.forms[0].sm_ex_ip_addr.value) == false) {
		webAlert('유효하지 않은 외부 IP주소입니다 : ' +document.forms[0].sm_ex_ip_addr.value);
		return false;
	}

	if (isValidIpAddress(document.forms[0].sm_in_ip_addr.value) == false) {
		webAlert('유효하지 않은 내부 IP주소입니다 : ' +document.forms[0].sm_in_ip_addr.value);
		return false;
	}

	if (isValidPort(document.forms[0].sm_ex_port_start.value) == false) {
		webAlert('유효하지 않은 외부 포트 시작 입니다 : ' +document.forms[0].sm_ex_port_start.value);
		return false;
	}

	if (isValidPort(document.forms[0].sm_ex_port_end.value) == false) {
		webAlert('유효하지 않은 외부 포트 끝 입니다 : ' +document.forms[0].sm_ex_port_end.value);
		return false;
	}

	if (isValidPort(document.forms[0].sm_ex_port_end.value) == false) {
		webAlert('유효하지 않은 내부 PORT 입니다 : ' +document.forms[0].sm_ex_port_end.value);
		return false;
	}

	if(es > ee){
		webAlert('외부포트시작이 외부포트끝 보다 큽니다');
		return false;
	}

	return true;
}

function btnApplySave(save_type)
{
	var loc;

	switch(save_type) {
		case 0:		/* port fwd */
			/* check sanity */
			if(checkPF() != true) return;

			loc  = 'portfwsrv.cmd?action=add';
			loc += '&srvName=USER_PF';
			loc += '&dstWanIf='+'eth4.1';
			loc += '&remoteAddr=port_fw';
			loc += '&srvAddr=' +  document.forms[0].pf_in_ip_addr.value;
			loc += '&proto='   +  document.forms[0].pf_proto.selectedIndex + ',';
			loc += '&eStart='  +  document.forms[0].pf_ex_port_start.value + ',';
			loc += '&eEnd='    +  document.forms[0].pf_ex_port_end.value + ',';
			loc += '&iStart='  +  document.forms[0].pf_in_port_start.value + ',';
			loc += '&iEnd='    +  document.forms[0].pf_in_port_end.value + ',';
			break;

		case 1:
			if(checkSM() != true) return;

			loc  = 'scvrtsrv.cmd?action=add';
			loc += '&srvName=USER_SM';
			loc += '&dstWanIf='+'eth4.1';
			loc += '&remoteAddr=' + document.forms[0].sm_ex_ip_addr.value;
			loc += '&srvAddr='    + document.forms[0].sm_in_ip_addr.value;
			loc += '&proto='      + document.forms[0].sm_proto.selectedIndex + ',';
			loc += '&eStart='     + document.forms[0].sm_ex_port_start.value + ',';
			loc += '&eEnd='       + document.forms[0].sm_ex_port_end.value + ',';
			loc += '&iStart='     + document.forms[0].sm_in_port_start.value + ',';
			loc += '&iEnd='       + document.forms[0].sm_in_port_start.value + ',';
			break;

		case 2:		/* DMZ */
			if(checkDmz() == false) return;
			loc  = 'nat_dmz.cgi?';
			loc += 'wv_dmzip=' + document.forms[0].dmzAddr.value;
			break;
		
		case 3:
			loc  = 'nat_functions_hair.cgi?';
			loc += 'nat_hair_enable=' + document.forms[0].hairEnable.value;
			break;
	}

	loc +='&sessionKey=' + sessionKey;

	var code = 'location="' + loc + '"';
	eval(code);
}

function frmDmzEnable() {
	var x = document.getElementById("dmzEnable");
	var i = x.selectedIndex;

	switch( String(i) )
	{
		case '1' :
			$('#dmz_type_str').html(dmz_mode_msg.dmz.name);
			$('#dmzAddr').attr('placeholder', dmz_mode_msg.dmz.example);
			$('#dmz_mode_tr').css('display', '');
			document.forms[0].dmzAddr.disabled = false;
			break;
			
		case '2' :
			$('#dmz_type_str').html(dmz_mode_msg.sdmz.name);
			$('#dmzAddr').attr('placeholder', dmz_mode_msg.sdmz.example);
			$('#dmz_mode_tr').css('display', '');
			document.forms[0].dmzAddr.disabled = false;
			break;
		
		case '0' :
		default:
			$('#dmz_type_str').html(dmz_mode_msg.dmz.name);
			$('#dmzAddr').attr('placeholder', dmz_mode_msg.dmz.example);
			$('#dmz_mode_tr').css('display', 'none');
			document.forms[0].dmzAddr.disabled = true;
			document.forms[0].dmzAddr.value   ='';			
			break;
		
	}
	
}

function frmLoad() {
	var nat  = '1';
	var loc  = 'msg_nat.html';
	var code = 'location="' + loc + '"';
	var addr;

	if(nat != '1')
	{
		eval(code);
		return;
	}

	addr = '';
	if(addr != '') {
		document.forms[0].dmzEnable.selectedIndex = 1;
	}
	else {
		$('#dmz_mode_tr').css('display', 'none');
		document.forms[0].dmzEnable.selectedIndex = 0;
		document.forms[0].dmzAddr.disabled = true;
	}
	document.forms[0].dmzAddr.value = addr;

	document.forms[0].hairEnable.value = 0;
	
	return;
}
</script>
</head>
<body onLoad='frmLoad()'>

<script language="javascript">
showmenubar();
</script>



<form>
<div class="container">
	<div class="navi clfx">
		<ul class="clfx">
			<li><img src="img/navi_home.png" alt="home" /><span>Home </span></li>
			<li>NAT/라우터 </li>
			<li>포트 포워드</li>
		</ul>
	</div>

	<h1 class="title_style_1">포트 포워드</h1>
	<p>포트 포워드 기능을 설정합니다(NAT 모드 전용 기능).</p>
	<hr>

	<h2 class="title_style_2">NAT Hairpinning</h2>
    <div class="tb_style_2">
        <table>
			<colgroup>
				<col style="width:30%;" />
				<col style="" />
			</colgroup>
			<tbody>
			<tr>
				<th scope="col"><center>NAT Hairpinning 활성화</center></th>
				<td>
					<select name='hairEnable' id="hairEnable">
						<option value="0">비활성화</option>
						<option value="1">활성화</option>
					</select>
				</td>
			</tr>
			</tbody>
        </table>
	</div>
	
	<div class="txt_c pt_20">
		<input type="button" onclick="btnApplySave(3)" value="적용" class="basic-btn01 btn-blue-bg" >
	</div>	

	<h2 class="title_style_2">포트 포워드 리스트 및 설정</h2>
	<div class="tb_style_1 scroll">
		<table>
			<colgroup>
				<col style="width:13.5%;" />
				<col style="width:15%;"   />
				<col style="" />
				<col style="" />
				<col style="" />
				<col style="" />
				<col style="" />
				<!--col style="" /-->
			</colgroup>
			<thead>
				<tr>
					<th scope='col'><center>선택</center></th>
					<th scope='col'><center>프로토콜</center></th>
					<th scope='col'><center>외부 포트 시작</center></th>
					<th scope='col'><center>외부 포트 끝</center></th>
					<th scope='col'><center>내부 IP 주소</center></th>
					<th scope='col'><center>내부 포트 시작</center></th>
					<th scope='col'><center>내부 포트 끝</center></th>
					<!--th scope='col'><center>설명</center></th-->
				</tr>
			</thead>
			<tbody>
				   <tr>
 	 <td><center><input type='checkbox' name='pf_rml' value='(null)|192.168.45.20|4000|4000|TCP or UDP|8000|8000'><center></td>
		<td><center>TCP/UDP</center></td>
 	 <td><center>4000</center></td>
 	 <td><center>4000</center></td>
 	 <td><center>192.168.45.20</center></td>
 	 <td><center>8000</center></td>
 	 <td><center>8000</center></td>
   </tr>

				<tr>
					<th scope="row">리스트 추가</th>
					<td>
						<center>
						<select id="pf_proto">
							<option id="0">TCP/UDP</option>
							<option id="1">TCP</option>
							<option id="2">UDP</option>
						</select>
						</center>
					</td>
					<td><input id="pf_ex_port_start" type="text" style="width:100%"></td>
					<td><input id="pf_ex_port_end"   type="text" style="width:100%"></td>
					<td><input id="pf_in_ip_addr"    type="text" style="width:100%"></td>
					<td><input id="pf_in_port_start" type="text" style="width:100%"></td>
					<td><input id="pf_in_port_end"   type="text" style="width:100%"></td>
					<!--td><input id="sm_description" type="text" style="width:100%"></td-->
				</tr>
			</tbody>
		</table>
	</div>

	<div class="txt_c pt_20">
		<input type="button" onclick="btnApplySave(0)" class="basic-btn01 btn-gray-bg mr_10" value="추가">
		<input type="button" onclick="removeClick(0, this.form.pf_rml)" class="basic-btn01 btn-gray-bg2 mr_10"value="삭제">
	</div>

<!--
	<h2 class="title_style_2">고정 NAT 세션 설정</h2>
	<div class="tb_style_2">
		<table>
			<colgroup>
				<col style="" />
				<col style="" />
				<col style="" />
				<col style="" />
				<col style="" />
				<col style="" />
				<col style="" />
			</colgroup>
			<thead>
				<tr>
					<th scope="col"><center>선택</center></th>
					<th scope="col"><center>프로토콜</center></th>
					<th scope="col"><center>외부 IP</center></th>
					<th scope="col"><center>외부 포트 시작</center></th>
					<th scope="col"><center>외부 포트 끝</center></th>
					<th scope="col"><center>내부 IP 주소</center></th>
					<th scope="col"><center>내부 포트</center></th>
				</tr>
			</thead>
			<tbody>
				
				<tr>
					<th scope="row">리스트 추가</th>
					<td>
						<center>
						<select id="sm_proto">
							<option id="0">TCP/UDP</option>
							<option id="1">TCP</option>
							<option id="2">UDP</option>
						</select>
						</center>
					</td>
					<td><input id="sm_ex_ip_addr"    type="text" style="width:100%"></td>
					<td><input id="sm_ex_port_start" type="text" style="width:100%"></td>
					<td><input id="sm_ex_port_end"   type="text" style="width:100%"></td>
					<td><input id="sm_in_ip_addr"    type="text" style="width:100%"></td>
					<td><input id="sm_in_port_start" type="text" style="width:100%"></td>
				</tr>
			</tbody>
		</table>
	</div>

	<div class="txt_c pt_20">
		<input type="button" onclick="btnApplySave(1)" class="basic-btn01 btn-gray-bg mr_10" value="추가">
		<input type="button" onclick="removeClick(1, this.form.sm_rml)" class="basic-btn01 btn-gray-bg2 mr_10"value="삭제">
	</div>
-->

	<h2 class="title_style_2">DMZ 설정</h2>
    <div class="tb_style_2">
        <table>
			<colgroup>
				<col style="width:30%;" />
				<col style="" />
			</colgroup>
			<tbody>
			<tr>
				<th scope="col"><center>DMZ 모드</center></th>
				<td>
					<select name='dmzEnable' id="dmzEnable" onchange="frmDmzEnable()">
						<option id="0">비활성화</option>
						<option id="1">DMZ</option>
						<option id="2">Super DMZ</option>
					</select>
				</td>
			</tr>
			<tr id='dmz_mode_tr'>
				<th scope="col"><center><p id='dmz_type_str'>IP 주소</p></center></th>
				<td><center><input type='text' name='dmzAddr' id='dmzAddr' placeholder=''></center></td>
			 </tr>
			</tbody>
        </table>
	</div>

	<div class="txt_c pt_20">
		<input type="button" onclick="btnApplySave(2)" value="적용" class="basic-btn01 btn-blue-bg" >
	</div>
</div>
</form>
</body>
</html>
