<!DOCTYPE html>
<! Copyright (c) Realtek Semiconductor Corp., 2003. All Rights Reserved. ->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html" charset="utf-8">
<meta HTTP-EQUIV="Pragma" CONTENT="no-cache">
<meta HTTP-equiv="Cache-Control" content="no-cache">
<meta name="viewport" content="width=device-width">
<link rel="stylesheet" href="/admin/bootstrap.min.css">
<link rel="stylesheet" href="/admin/reset.css">
<link rel="stylesheet" href="/admin/base.css">
<link rel="stylesheet" href="/admin/style.css">
<script language="javascript" src="common.js"></script>
<script type="text/javascript" src="share.js"></script>
<title>ACL Configuration</title>
<SCRIPT>
var _telnet = 0;
var _ftp = 0;
var _tftp = 0;
var _web = 0;
var _https = 0;
var _snmp = 0;
var _ssh = 0;

function postACL( enable, interface, aclIP )
{
/*
	document.acl.enable.checked = enable;		
	document.acl.interface.value = interface;	
*/
	document.acl.aclIP.value = aclIP;	
}

function addClick(obj)
{
/*	if (document.acl.aclIP.value=="") {
		alert("Enter Source Network ID !");
		document.acl.aclIP.focus();
		return false;
	}

	if (document.acl.aclMask.value=="") {
		alert("Enter Subnet Mask !");
		document.acl.aclMask.focus();
		return false;
	}
	
	if ( validateKey( document.acl.aclIP.value ) == 0 ) {
		alert("Invalid Source value.");
		document.acl.aclIP.focus();
		return false;
	}
	if( IsLoopBackIP( document.acl.aclIP.value)==1 ) {
		alert("Invalid IP address value.");
		document.acl.aclIP.focus();
		return false;
  	}
	if ( !checkDigitRange(document.acl.aclIP.value,1,0,223) ) {
		alert('Invalid Source range in 1st digit. It should be 0-223.');
		document.acl.aclIP.focus();
		return false;
	}
	if ( !checkDigitRange(document.acl.aclIP.value,2,0,255) ) {
		alert('Invalid Source range in 2nd digit. It should be 0-255.');
		document.acl.aclIP.focus();
		return false;
	}
	if ( !checkDigitRange(document.acl.aclIP.value,3,0,255) ) {
		alert('Invalid Source range in 3rd digit. It should be 0-255.');
		document.acl.aclIP.focus();
		return false;
	}
	if ( !checkDigitRange(document.acl.aclIP.value,4,0,254) ) {
		alert('Invalid Source range in 4th digit. It should be 0-254.');
		document.acl.aclIP.focus();
		return false;
	}	

	if ( validateKey( document.acl.aclMask.value ) == 0 ) {
		alert("Invalid Source value.");
		document.acl.aclMask.focus();
		return false;
	}
	if( IsLoopBackIP( document.acl.aclMask.value)==1 ) {
		alert("Invalid IP address value.");
		document.acl.aclMask.focus();
		return false;
  	}
	if ( !checkDigitRange(document.acl.aclMask.value,1,0,255) ) {
		alert('Invalid Source range in 1st digit. It should be 0-255.');
		document.acl.aclMask.focus();
		return false;
	}
	if ( !checkDigitRange(document.acl.aclMask.value,2,0,255) ) {
		alert('Invalid Source range in 2nd digit. It should be 0-255.');
		document.acl.aclMask.focus();
		return false;
	}
	if ( !checkDigitRange(document.acl.aclMask.value,3,0,255) ) {
		alert('Invalid Source range in 3rd digit. It should be 0-255.');
		document.acl.aclMask.focus();
		return false;
	}
	if ( !checkDigitRange(document.acl.aclMask.value,4,0,255) ) {
		alert('Invalid Source range in 4th digit. It should be 0-255.');
		document.acl.aclMask.focus();
		return false;
	}	
*/	
	/*if (!checkNetIP(document.acl.aclstartIP, 1))
		return false;
	if (!checkNetIP(document.acl.aclendIP, 1))
		return false;*/
	if (!validateAclInputs()) {
		return false;
	}
	with ( document.forms[0] ) 
	{
/*
		if(interface.value == 1)	//wan
		{
			if((_telnet || _ftp || _tftp || _web || _https || _snmp || _ssh || _icmp)==0 )
			{
				alert('please choose service.');
				return false;
			}
		}
*/
	}
	document.forms[0].addIP.isclick = 1;
	postTableEncrypt(document.forms[0].postSecurityFlag, document.forms[0]);
	return true;
}

function deleteClick()
{
	if ( !confirm('Delete the selected entry?') ) {
		return false;
	}
	else
	{
		document.forms[0].delIP.isclick = 1;
		postTableEncrypt(document.forms[0].postSecurityFlag, document.forms[0]);
		return true;
	}
}
	
function disableDelButton()
{
  if (verifyBrowser() != "ns") {
	disableButton(document.acl.delIP);
	//disableButton(document.acl.delAllIP);
  }
}

function intfchange(obj)
{
	with ( document.forms[0] ) 
	{
		if(obj.value == "0")
		{
			if (document.getElementById) {  // DOM3 = IE5, NS6
				document.getElementById('serviceLANID').style.display = '';
				document.getElementById('serviceLANID2').style.display = '';
				document.getElementById('div_lan').style.display = '';
				document.getElementById('serviceWANID').style.display = 'none';
			}
			else {
				if (document.layers == false) { // IE4
					document.all.serviceLANID.style.display = '';
					document.all.serviceLANID2.style.display = '';
					document.all.div_lan.style.display = '';
					document.all.serviceWANID.style.display = 'none';
				}
			}
		}
		else
		{
			if (document.getElementById){ // DOM3 = IE5, NS6
				document.getElementById('serviceLANID').style.display = 'none';
				document.getElementById('serviceLANID2').style.display = 'none';
				document.getElementById('div_lan').style.display = 'none';
				document.getElementById('serviceWANID').style.display = '';
			}
			else {
				if (document.layers == false) { // IE4
					document.all.serviceLANID.style.display = 'none';
					document.all.serviceLANID2.style.display = 'none';
					document.all.div_lan.style.display = 'none';
					document.all.serviceWANID.style.display = '';
				}
			}
		}
	}
}

function serviceChange ()
{	
	
		if (document.acl.l_any.checked)
		{
			if (document.getElementById) {  // DOM3 = IE5, NS6				
				document.getElementById('serviceLANID2').style.display = 'none';
			}
			else {
				if (document.layers == false) { // IE4					
					document.all.serviceLANID2.style.display = 'none';
				}
			}
		}
		else
		{
			if (document.getElementById){ // DOM3 = IE5, NS6				
				document.getElementById('serviceLANID2').style.display = '';
			}
			else {
				if (document.layers == false) { // IE4					
					document.all.serviceLANID2.style.display = '';
				}
			}
		}
	
}

function on_submit(obj)
{
	obj.isclick = 1;
	postTableEncrypt(document.forms[0].postSecurityFlag, document.forms[0]);
	return true;
}

function validateAclInputs()
{
	if (document.acl.aclIP.value === "") {
		alert("Enter Source IP address.");
		document.acl.aclIP.focus();
		return false;
	}

	if (document.acl.aclMask.value === "") {
		alert("Enter Subnet Mask.");
		document.acl.aclMask.focus();
		return false;
	}

	if (validateKey(document.acl.aclIP.value) === 0) {
		alert("Invalid IP address value.");
		document.acl.aclIP.focus();
		return false;
	}

	if (IsLoopBackIP(document.acl.aclIP.value) === 1) {
		alert("Invalid IP address value.");
		document.acl.aclIP.focus();
		return false;
	}

	if (!checkDigitRange(document.acl.aclIP.value, 1, 0, 223)) {
		alert("Invalid IP address range in 1st digit. It should be 0-223.");
		document.acl.aclIP.focus();
		return false;
	}

	if (!checkDigitRange(document.acl.aclIP.value, 2, 0, 255)) {
		alert("Invalid IP address range in 2nd digit. It should be 0-255.");
		document.acl.aclIP.focus();
		return false;
	}

	if (!checkDigitRange(document.acl.aclIP.value, 3, 0, 255)) {
		alert("Invalid IP address range in 3rd digit. It should be 0-255.");
		document.acl.aclIP.focus();
		return false;
	}

	if (!checkDigitRange(document.acl.aclIP.value, 4, 0, 254)) {
		alert("Invalid IP address range in 4th digit. It should be 0-254.");
		document.acl.aclIP.focus();
		return false;
	}

	if (validateKey(document.acl.aclMask.value) === 0) {
		alert("Invalid subnet mask value.");
		document.acl.aclMask.focus();
		return false;
	}

	if (IsLoopBackIP(document.acl.aclMask.value) === 1) {
		alert("Invalid subnet mask value.");
		document.acl.aclMask.focus();
		return false;
	}

	if (!checkDigitRange(document.acl.aclMask.value, 1, 0, 255)) {
		alert("Invalid subnet mask range in 1st digit. It should be 0-255.");
		document.acl.aclMask.focus();
		return false;
	}

	if (!checkDigitRange(document.acl.aclMask.value, 2, 0, 255)) {
		alert("Invalid subnet mask range in 2nd digit. It should be 0-255.");
		document.acl.aclMask.focus();
		return false;
	}

	if (!checkDigitRange(document.acl.aclMask.value, 3, 0, 255)) {
		alert("Invalid subnet mask range in 3rd digit. It should be 0-255.");
		document.acl.aclMask.focus();
		return false;
	}

	if (!checkDigitRange(document.acl.aclMask.value, 4, 0, 255)) {
		alert("Invalid subnet mask range in 4th digit. It should be 0-255.");
		document.acl.aclMask.focus();
		return false;
	}

	return true;
}
</SCRIPT>
</head>

<body>
<div class="intro_main ">
	<p class="intro_title">ACL Configuration</p>
	<p class="intro_content">
		This page configures Access Control List (ACL) IP addresses. When ACL is enabled,
		only IP addresses in the ACL table can access the device.
	</p>
</div>
<form action=/boaform/admin/formACL method=POST name="acl">
	<div class="data_common data_common_notitle">
		<table>
			<input type="hidden" name="lan_ip" value="">
			<input type="hidden" name="lan_mask" value="">
				<tr>
					<th width="30%">ACL Capability:</th>
					<td>
						<input type="radio" value="0" name="aclcap" checked>Disable&nbsp;&nbsp;
						<input type="radio" value="1" name="aclcap">Enable
					</td>
					<td><input class="inner_btn" type="submit" value="Apply Changes" name="apply" onClick="return on_submit(this)">&nbsp;&nbsp; </td>
				</tr> 
		</table>
		
		<table> 
			<tr>
				<th width="30%">Enable:</th>
				<td width="70%"><input type="checkbox" name="enable" value="1"></td>
			</tr>	  
			<tr>
				<th>Interface:</th>
				<td>      
					<select size="1" name="interface" onChange="intfchange(this)"> 
					<option value="0">LAN</option>
					<option value="1">WAN</option>
					</select>
				</td>
			</tr>
			<tr>
				<th>IP Address:</th>
				<td><input type="text" name="aclIP" size="15" maxlength="15" placeholder="192.168.1.10"></td>
			</tr>	  
			<tr>
				<th>Subnet Mask:</th>
				<td><input type="text" name="aclMask" size="15" maxlength="15" placeholder="255.255.255.0"></td>      
			</tr>
		</table>
	</div>
	<div class="btn_ctl">
	   <input class="link_bg" type="submit" value="Add" name="addIP" onClick="return addClick(this)">
	</div>

<!--input type="submit" value="Update" name="updateACL" onClick="return addClick()">&nbsp;&nbsp;
</tr-->

	<div class="column clearfix column_title">
		<div class="column_title_left"></div>
			<p>ACL Table</p>
		<div class="column_title_right"></div>
	</div>	
	<div class="data_common data_vertical">
		<table>
			<tr>
				<th>IP Address</th>
				<th>Subnet Mask</th>
				<th>Interface</th>
				<th>Action</th>
			</tr>
			<tr>
				<td colspan="4" class="empty_table">No ACL entries loaded.</td>
			</tr>
		</table>
	</div> 	
	<div class="btn_ctl clearfix">
		<input class="link_bg" type="submit" value="Delete Selected" name="delIP" onClick="return deleteClick(this)">    
		<input type="hidden" value="/admin/acl.html" name="submit-url">
		<input type="hidden" name="postSecurityFlag" value="">
	</div>  
</form>
</body>
</html>
